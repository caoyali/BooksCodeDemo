wireshark是一个很有名的工具但我之前一直没有特别研究过。现在么办法了， 老板让看某功能走的是ipv6 还是 ipv4, 其中有些新学习的东西希望记录一下

1 ipv6，我们的手机流量走的基本都只ipv6， 都是天然支持ipv6的。 这点要记住，也就是实在没有招的情况下，你又让能走ipv6， 实在没办法，牺牲流量发热点吧就
2 Win本，即使连接支持ipv6的网络，但是它发出来的热点，依然不支持ipv6！ 这个有点坑！
3 怎么测试你电脑连接的网络支不支持ipv6呢？  点击   http://ipv6-test.ch/   这个连接！里面可以查你电脑是不是ipv6

# wireshark
wireshark记住一点就行了，它只抓你PC上流过的数据包！如果你想抓手机上的，那么也得想办法借PC的网络，因为WS只抓PC。

## 问题的提出
我目前有一个需求就是：
抓安卓的文件上传功能走的是ipv6 还是ipv4. 但是抓这个前面要有很复杂的流程

我的电脑是MAC， 要用MAC手机抓安卓的包。 本来好好的，咱用MAC 连接网线发一个热点，安卓这么一连接，不就成了不就能抓包了。
但是事实往往更麻烦， 我们的公司网络在MAC上的表现是不能分享热点，但是在WIN上是可以分享热点的！可能mac实现的比较严格吧！ 那么至少我用mac分享热点的愿望泡汤了！
那么我用win分享热点，直接拿win上的WS抓包不就成了，但是我们的需求比较特殊，就是看看上传用的是不是ipv6！，但是win分享的热点，即使人家用的网络是ipv6的但是热点分享出来是ipv4！！！！决不能满足我看是否是ipv6的需求啊！！！所以靠链接win热点抓包，泡汤了！

那么还有什么办法呢？我们首先要找一个支持ipv6的网络啊！我们还得想办法连热点啊！这个热点也得是ipv6啊，而且这个热点的网络可以被ws跟踪啊！
我实际上没什么好办法的，甚至心里很迷的！但是强哥给了个机智的办法！
他让我， 用iphone流量发一个热点，那么这个热点肯定能支持ipv6， 然后再让iphone连mac电脑， 在terminal上键入命令，让MAC为你连接的这个手机建立一个虚拟的网络接口， 之后输入开始抓包的命令行，ws就可以捕获到这些信息了！下面我们看看怎么弄好的

命令总结：
```
rvictl -s 00008110-001971D90A07801E
sudo tcpdump -i rvi0 -n -s 0 -w dump.pcap tcp
```
## 解决

### phone手机发一个热点，让安卓手机连上再说

### 为iphone手机建立虚拟网络接口
首先数据线连接电脑
然后，打开电脑terminal执行
```
rvictl -s iphone的设备号
```
但是这个设备号是每个设备有一个独一无二的，怎么拿到这个值呢？
打开xcode！只要你的线没有问题的话，一般都会在。确保你目前链接的是你的手机！
![Snipaste_2022-07-08_15-34-26](/assets/Snipaste_2022-07-08_15-34-26.png)

![Snipaste_2022-07-08_15-37-15](/assets/Snipaste_2022-07-08_15-37-15.png)

确保连上了之后，打开这里，

![Snipaste_2022-07-08_15-38-12](/assets/Snipaste_2022-07-08_15-38-12.png)

箭头处就是iphone的设备号
![Snipaste_2022-07-08_15-39-05](/assets/Snipaste_2022-07-08_15-39-05_w5roew3k0.png)

所以在我的手机上我会再terminal键入：
```
rvictl -s 00008110-001971D90A07801E
```
正常情况下，terminal会提示 SUCCESS，  但是如果你的电脑是头一次搞这种的话，会出现FAIL， 针对这种情况，立东给我一个方式，真的挺麻烦的这块。

![WechatIMG273](/assets/WechatIMG273.jpeg)

注意： 找Apple.inc的时候，可能在界面上不能直接看到， 但是你多点点什么  更多啊，啥的，就能出来了！

然后整完之后，重启电脑，再执行 ``` rvictl -s 00008110-001971D90A07801E ```就好了！

### 开始抓包
如果你这个命令执行成功之后，
终端中输入（dump.pcap为生成的抓包文件名称，可任意命名；tcp为过滤条件，表示只抓tcp包，可也全部抓后在wireshark中再过滤）
sudo tcpdump -i rvi0 -n -s 0 -w dump.pcap tcp    就行了, 注意，这个rvi0 就是你上个命令分配的虚拟接口！这个是活的别直接按照死命令来！

## MAC 连接网线发热点
